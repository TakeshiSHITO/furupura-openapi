components:
  schemas:
    ProductReview:
      type: object
      required:
        - id
        - user_id
        - product_id
        - rating
        - title
        - comment
        - created_at
      properties:
        id:
          type: string
          format: uuid
          description: レビューID
        user_id:
          type: string
          format: uuid
          description: ユーザーID
        user_name:
          type: string
          description: ユーザー表示名
        product_id:
          type: string
          format: uuid
          description: 商品ID
        order_id:
          type: string
          format: uuid
          description: 注文ID（購入証明用）
        order_item_id:
          type: string
          format: uuid
          description: 注文明細ID
        rating:
          type: integer
          minimum: 1
          maximum: 5
          description: 評価（1-5）
        title:
          type: string
          maxLength: 100
          description: レビュータイトル
        comment:
          type: string
          maxLength: 2000
          description: レビューコメント
        pros:
          type: array
          items:
            type: string
          maxItems: 5
          description: 良い点
        cons:
          type: array
          items:
            type: string
          maxItems: 5
          description: 改善点
        images:
          type: array
          items:
            type: string
            format: uri
          maxItems: 10
          description: レビュー画像
        video_url:
          type: string
          format: uri
          description: レビュー動画URL
        verified_purchase:
          type: boolean
          default: false
          description: 購入確認済みフラグ
        is_recommended:
          type: boolean
          description: おすすめフラグ
        helpful_count:
          type: integer
          default: 0
          description: 役立った数
        unhelpful_count:
          type: integer
          default: 0
          description: 役立たなかった数
        reply_from_seller:
          $ref: '#/components/schemas/SellerReply'
        status:
          type: string
          enum:
            - pending
            - approved
            - rejected
            - hidden
          default: pending
          description: レビューステータス
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    SellerReply:
      type: object
      properties:
        seller_id:
          type: string
          format: uuid
        seller_name:
          type: string
        message:
          type: string
          maxLength: 1000
        replied_at:
          type: string
          format: date-time

    CreateReviewRequest:
      type: object
      required:
        - product_id
        - rating
        - title
        - comment
      properties:
        product_id:
          type: string
          format: uuid
        order_id:
          type: string
          format: uuid
        rating:
          type: integer
          minimum: 1
          maximum: 5
        title:
          type: string
          maxLength: 100
        comment:
          type: string
          maxLength: 2000
        pros:
          type: array
          items:
            type: string
          maxItems: 5
        cons:
          type: array
          items:
            type: string
          maxItems: 5
        is_recommended:
          type: boolean
        images:
          type: array
          items:
            type: string
            format: uri
          maxItems: 10
        video_url:
          type: string
          format: uri

    UpdateReviewRequest:
      type: object
      properties:
        rating:
          type: integer
          minimum: 1
          maximum: 5
        title:
          type: string
          maxLength: 100
        comment:
          type: string
          maxLength: 2000
        pros:
          type: array
          items:
            type: string
          maxItems: 5
        cons:
          type: array
          items:
            type: string
          maxItems: 5
        is_recommended:
          type: boolean
        images:
          type: array
          items:
            type: string
            format: uri
          maxItems: 10
        video_url:
          type: string
          format: uri

    ReviewHelpfulnessRequest:
      type: object
      required:
        - is_helpful
      properties:
        is_helpful:
          type: boolean
          description: 役立ったかどうか

    ReviewSummary:
      type: object
      properties:
        product_id:
          type: string
          format: uuid
        average_rating:
          type: number
          format: float
          minimum: 1
          maximum: 5
          description: 平均評価
        total_reviews:
          type: integer
          description: レビュー総数
        verified_purchase_count:
          type: integer
          description: 購入確認済みレビュー数
        rating_distribution:
          type: object
          properties:
            '1':
              type: integer
            '2':
              type: integer
            '3':
              type: integer
            '4':
              type: integer
            '5':
              type: integer
          description: 評価分布
        recommendation_rate:
          type: number
          format: float
          minimum: 0
          maximum: 100
          description: おすすめ率（％）
        top_positive_keywords:
          type: array
          items:
            type: string
          description: ポジティブキーワード
        top_negative_keywords:
          type: array
          items:
            type: string
          description: ネガティブキーワード

    SellerReviewSummary:
      type: object
      properties:
        seller_id:
          type: string
          format: uuid
        average_rating:
          type: number
          format: float
          minimum: 1
          maximum: 5
        total_reviews:
          type: integer
        response_rate:
          type: number
          format: float
          minimum: 0
          maximum: 100
          description: 返信率（％）
        average_response_time:
          type: integer
          description: 平均返信時間（時間）
