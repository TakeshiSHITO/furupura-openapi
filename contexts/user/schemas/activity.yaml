components:
  schemas:
    UserActivity:
      type: object
      required:
        - id
        - user_id
        - type
        - timestamp
      properties:
        id:
          type: string
          format: uuid
          description: アクティビティID
        user_id:
          type: string
          format: uuid
          description: ユーザーID
        session_id:
          type: string
          format: uuid
          description: セッションID
        type:
          type: string
          enum:
            - login
            - logout
            - search
            - view_product
            - view_category
            - add_to_cart
            - remove_from_cart
            - add_to_favorite
            - remove_from_favorite
            - add_to_wishlist
            - remove_from_wishlist
            - purchase
            - cancel_order
            - review
            - share
            - apply_coupon
            - change_settings
          description: アクティビティタイプ
        target_type:
          type: string
          enum:
            - product
            - category
            - order
            - review
            - coupon
            - user
          description: 対象タイプ
        target_id:
          type: string
          description: 対象のID（商品ID、注文IDなど）
        metadata:
          type: object
          additionalProperties: true
          description: アクティビティの詳細データ
        device_info:
          $ref: '#/components/schemas/DeviceInfo'
        location_info:
          $ref: '#/components/schemas/LocationInfo'
        timestamp:
          type: string
          format: date-time
          description: アクティビティ発生日時

    DeviceInfo:
      type: object
      properties:
        device_type:
          type: string
          enum:
            - desktop
            - mobile
            - tablet
            - smart_tv
            - wearable
          description: デバイスタイプ
        os:
          type: string
          description: OS名
        os_version:
          type: string
          description: OSバージョン
        browser:
          type: string
          description: ブラウザ名
        browser_version:
          type: string
          description: ブラウザバージョン
        app_version:
          type: string
          description: アプリバージョン
        user_agent:
          type: string
          description: ユーザーエージェント
        screen_resolution:
          type: string
          description: 画面解像度

    LocationInfo:
      type: object
      properties:
        ip_address:
          type: string
          description: IPアドレス（マスク済み）
        country:
          type: string
          description: 国
        region:
          type: string
          description: 地域・州
        city:
          type: string
          description: 市区町村
        postal_code:
          type: string
          description: 郵便番号

    UserSession:
      type: object
      required:
        - id
        - user_id
        - started_at
      properties:
        id:
          type: string
          format: uuid
          description: セッションID
        user_id:
          type: string
          format: uuid
          description: ユーザーID
        started_at:
          type: string
          format: date-time
          description: セッション開始時刻
        ended_at:
          type: string
          format: date-time
          description: セッション終了時刻
        duration_seconds:
          type: integer
          description: セッション時間（秒）
        page_views:
          type: integer
          description: ページビュー数
        events_count:
          type: integer
          description: イベント数
        device_info:
          $ref: '#/components/schemas/DeviceInfo'
        location_info:
          $ref: '#/components/schemas/LocationInfo'

    UserPreferences:
      type: object
      properties:
        user_id:
          type: string
          format: uuid
        language:
          type: string
          enum:
            - ja
            - en
            - zh-CN
            - zh-TW
            - ko
            - vi
            - th
          default: ja
          description: 言語設定
        currency:
          type: string
          enum:
            - JPY
            - USD
            - EUR
            - CNY
            - KRW
            - VND
            - THB
          default: JPY
          description: 通貨設定
        timezone:
          type: string
          default: Asia/Tokyo
          description: タイムゾーン
        date_format:
          type: string
          enum:
            - YYYY-MM-DD
            - DD/MM/YYYY
            - MM/DD/YYYY
          default: YYYY-MM-DD
          description: 日付フォーマット
        display_settings:
          $ref: '#/components/schemas/DisplaySettings'
        privacy_settings:
          $ref: '#/components/schemas/PrivacySettings'
        accessibility_settings:
          $ref: '#/components/schemas/AccessibilitySettings'

    DisplaySettings:
      type: object
      properties:
        theme:
          type: string
          enum:
            - light
            - dark
            - auto
          default: light
          description: テーマ設定
        items_per_page:
          type: integer
          enum:
            - 20
            - 40
            - 60
            - 100
          default: 20
          description: 1ページあたりの表示件数
        default_sort:
          type: string
          enum:
            - relevance
            - price_low_high
            - price_high_low
            - newest
            - rating
            - popularity
          default: relevance
          description: デフォルトソート順
        show_sold_out:
          type: boolean
          default: true
          description: 売り切れ商品を表示
        show_adult_content:
          type: boolean
          default: false
          description: アダルトコンテンツを表示
        compact_view:
          type: boolean
          default: false
          description: コンパクトビュー

    PrivacySettings:
      type: object
      properties:
        profile_visibility:
          type: string
          enum:
            - public
            - friends
            - private
          default: private
          description: プロフィール公開設定
        show_purchase_history:
          type: boolean
          default: false
          description: 購入履歴を公開
        show_wishlist:
          type: boolean
          default: false
          description: ウィッシュリストを公開
        allow_recommendations:
          type: boolean
          default: true
          description: レコメンデーションを許可
        allow_analytics:
          type: boolean
          default: true
          description: 分析データの収集を許可
        allow_third_party_cookies:
          type: boolean
          default: false
          description: サードパーティCookieを許可

    AccessibilitySettings:
      type: object
      properties:
        font_size:
          type: string
          enum:
            - small
            - medium
            - large
            - extra_large
          default: medium
          description: フォントサイズ
        high_contrast:
          type: boolean
          default: false
          description: ハイコントラストモード
        reduce_motion:
          type: boolean
          default: false
          description: アニメーションを減らす
        screen_reader_mode:
          type: boolean
          default: false
          description: スクリーンリーダーモード
        keyboard_navigation:
          type: boolean
          default: false
          description: キーボードナビゲーション

    UserReferral:
      type: object
      required:
        - id
        - referrer_id
        - referral_code
        - created_at
      properties:
        id:
          type: string
          format: uuid
        referrer_id:
          type: string
          format: uuid
          description: 紹介者ID
        referred_id:
          type: string
          format: uuid
          description: 被紹介者ID
        referral_code:
          type: string
          description: 紹介コード
        referral_link:
          type: string
          format: uri
          description: 紹介リンク
        status:
          type: string
          enum:
            - pending
            - registered
            - first_purchase
            - completed
            - expired
          description: 紹介ステータス
        reward_type:
          type: string
          enum:
            - points
            - discount
            - cash_back
          description: 報酬タイプ
        referrer_reward:
          type: number
          description: 紹介者報酬
        referred_reward:
          type: number
          description: 被紹介者報酬
        created_at:
          type: string
          format: date-time
        registered_at:
          type: string
          format: date-time
        completed_at:
          type: string
          format: date-time
        expires_at:
          type: string
          format: date-time
